<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Home - Government Job Portal</title>
	<link rel="stylesheet" href="/style.css">
	<style>
		.hero { padding: 60px 20px; text-align: center; }
		.hero h2 { color: white; font-size: 2em; margin-bottom: 12px; }
		.hero p { color: rgba(255,255,255,0.9); margin-bottom: 20px; }
		.persons-list { padding: 40px 20px; }
		.persons-list h2 { text-align: center; margin-bottom: 30px; }
		.persons-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
		.person-card { border: 1px solid #ddd; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
		.person-image { width: 100%; height: 200px; overflow: hidden; background-color: #f0f0f0; }
		.person-image img { width: 100%; height: 100%; object-fit: cover; }
		.image-placeholder { display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; background-color: #e0e0e0; color: #666; font-size: 14px; }
		.person-details { padding: 15px; }
		.person-details h3 { margin: 0 0 10px 0; font-size: 18px; }
		.person-details p { margin: 8px 0; font-size: 14px; color: #555; }
		.person-details strong { color: #333; }
		.person-actions { margin-top: 12px; padding-top: 12px; border-top: 1px solid #eee; display: flex; gap: 8px; flex-wrap: wrap; }
		.person-actions form { display: inline; }
		.person-actions a { text-decoration: none; display: inline-block; }
		.btn-primary { background-color: #007bff; color: white; padding: 6px 12px; border: none; border-radius: 4px; cursor: pointer; text-decoration: none; font-size: 13px; }
		.btn-primary:hover { background-color: #0056b3; }
		.btn-danger { background-color: #dc3545; color: white; padding: 6px 12px; border: none; border-radius: 4px; cursor: pointer; text-decoration: none; font-size: 13px; }
		.btn-danger:hover { background-color: #c82333; }
		.btn-sm { padding: 4px 8px; font-size: 12px; }
		.search-section { padding: 30px 20px; background-color: #f9f9f9; margin: 20px 0; border-radius: 8px; }
		.search-section h3 { margin-top: 0; margin-bottom: 15px; font-size: 20px; }
		.search-form { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
		.search-form input { flex: 1; min-width: 200px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; }
		.pagination-section { padding: 30px 20px; text-align: center; }
		.pagination { background-color: #f9f9f9; padding: 15px; border-radius: 8px; justify-content: center; }
		.page-item.disabled > .page-link { color: #6c757d; cursor: not-allowed; background-color: #e9ecef; }
		.page-item.active > .page-link { z-index: 3; color: #fff; background-color: #007bff; border-color: #007bff; }
		.d-flex { display: flex; }
		.justify-content-center { justify-content: center; }
	</style>
</head>
<body>
	<div class="container">
		<header>
			<h1>Government Job Portal</h1>
			<p>Apply online and download your admit card.</p>
			<div style="text-align: right; margin-top: 10px;">
				<% if (user) { %>
					<span style="color: white; margin-right: 15px;">Welcome, <%= user.email %></span>
					<a href="/logout" style="color: white; text-decoration: none;">Logout</a>
				<% } else { %>
					<a href="/signup" style="color: white; text-decoration: none; margin-right: 15px;">Sign Up</a>
					<a href="/login" style="color: white; text-decoration: none;">Login</a>
				<% } %>
			</div>
		</header>
		<main>
			<section class="hero">
				<h2>Welcome to the Application Portal</h2>
				<p>Please use the buttons below to apply or view your admit card.</p>
				<div class="button-group">
					<a href="/apply" class="btn btn-primary">Apply Now</a>
					<a href="/" class="btn btn-secondary">Home</a>
				</div>
			</section>

			<section class="search-section">
				<h3>Search Applications</h3>
				<form method="GET" action="/" class="search-form">
					<input type="text" name="search" placeholder="Search by name..." value="<%= search %>">
					<button type="submit" class="btn btn-primary">Search</button>
					<a href="/" class="btn btn-secondary">Clear</a>
				</form>
			</section>

			<% if (persons && persons.length > 0) { %>
			<section class="persons-list">
				<h2>Submitted Applications</h2>
				<div class="persons-grid">
					<% persons.forEach(person => { %>
					<div class="person-card">
						<div class="person-image">
							<% if (person.image) { %>
								<img src="<%= person.image %>" alt="<%= person.name %>">
							<% } else { %>
								<div class="image-placeholder">No Image</div>
							<% } %>
						</div>
						<div class="person-details">
							<h3><%= person.name || 'N/A' %></h3>
							<p><strong>Age:</strong> <%= person.age || 'N/A' %></p>
							<p><strong>Email:</strong> <%= person.email || 'N/A' %></p>
							<% if (person.registrationId) { %>
								<p><strong>Registration ID:</strong> <%= person.registrationId %></p>
							<% } %>
							<div class="person-actions">
								<a href="/edit/<%= person._id %>" class="btn btn-primary btn-sm">Edit</a>
								<form method="POST" action="/delete/<%= person._id %>" style="display:inline;">
									<button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this application?');">Delete</button>
								</form>
							</div>
						</div>
					</div>
					<% }); %>
				</div>
			</section>

			<% if (totalPages && totalPages > 1) { %>
			<section class="pagination-section">
				<nav aria-label="Page navigation" class="d-flex justify-content-center">
					<ul class="pagination">
						<% if (currentPage > 1) { %>
						<li class="page-item">
							<a class="page-link" href="/?page=1<%= search ? '&search=' + search : '' %>">First</a>
						</li>
						<li class="page-item">
							<a class="page-link" href="/?page=<%= currentPage - 1 %><%= search ? '&search=' + search : '' %>">Previous</a>
						</li>
						<% } else { %>
						<li class="page-item disabled">
							<span class="page-link">First</span>
						</li>
						<li class="page-item disabled">
							<span class="page-link">Previous</span>
						</li>
						<% } %>
						
						<li class="page-item active">
							<span class="page-link"><%= currentPage %> of <%= totalPages %></span>
						</li>
						
						<% if (currentPage < totalPages) { %>
						<li class="page-item">
							<a class="page-link" href="/?page=<%= currentPage + 1 %><%= search ? '&search=' + search : '' %>">Next</a>
						</li>
						<li class="page-item">
							<a class="page-link" href="/?page=<%= totalPages %><%= search ? '&search=' + search : '' %>">Last</a>
						</li>
						<% } else { %>
						<li class="page-item disabled">
							<span class="page-link">Next</span>
						</li>
						<li class="page-item disabled">
							<span class="page-link">Last</span>
						</li>
						<% } %>
					</ul>
				</nav>
			</section>
			<% } %>
			<% } %>
		</main>
	</div>
</body>
</html>
